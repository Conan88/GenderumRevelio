* Notes
[[file:src/genderumrevelio/networkconfigs/lstmtest.py][lstm config]]
Learning rate at 0.1 and 0.0000001 seams to be too much. 
Then the rate is at 8.1, which is much more than usual(about 0.8).

Learning rate at 0.001 is promising. 

When running with 0.0000001 it crashed. Maybe to low learning rate?

Learning rate at 0.0001 has bin the best up to now. Results are about 54%. 

Trying tanh as activation, based on tips for Morten Goodwin.


** Maxlen
   Seams like maxlen change form 80 to 1000 has improbed the accuracy cuite a bit!
   That is interesting to see, and this as maybe bin one of our big errors.

* TODO Learning rates
- Learning rate [7/7]
  - [X] 0.1 fail(low acc)
  - [X] 0.01 fail(low acc)
  - [X] 0.001
  - [X] 0.0001 best til now
  - [X] 0.00001
  - [X] 0.000001 fail
  - [X] 0.0000001 fail

- More tests [0/6]
  - [ ] only one gender
  - [ ] half the blog data
  - [ ] book data 
  - [ ] more lstm layers
  - [ ] mixing, train on blogs, validation on books
  - [ ] one hot encoded data
* Tested configurations
** LSTM model
*** Spec 1 
|--------------+--------+------------+---------------|
| max_features | maxlen | batch_size | learning_rate |
|--------------+--------+------------+---------------|
|        20000 |     80 |        164 |          0.01 |
|--------------+--------+------------+---------------|

|--------------------+-------+------------------------------------|
| Layer              | value | activation                         |
|--------------------+-------+------------------------------------|
| Embedding          |   128 |                                    |
|--------------------+-------+------------------------------------|
| Bidirectional LSTM |   128 | dropout 0.2, recurrent dropout 0.2 |
|--------------------+-------+------------------------------------|
| Dense              |   100 | relu                               |
|--------------------+-------+------------------------------------|
| Dense              |    50 | relu                               |
|--------------------+-------+------------------------------------|
| Dense              |     1 | sigmoid                            |
|--------------------+-------+------------------------------------|

|----------+-------|
| accuracy | score |
|----------+-------|
|          |       |
|----------+-------|
*** Spec 2
|--------------+--------+------------+---------------|
| max_features | maxlen | batch_size | learning_rate |
|--------------+--------+------------+---------------|
|        20000 |     80 |        164 |          0.01 |
|--------------+--------+------------+---------------|

|--------------------+-------+------------------------------------|
| Layer              | value | activation                         |
|--------------------+-------+------------------------------------|
| Embedding          |   128 |                                    |
|--------------------+-------+------------------------------------|
| Bidirectional LSTM |   128 | dropout 0.2, recurrent dropout 0.2 |
|--------------------+-------+------------------------------------|
| Dense              |   600 | relu                               |
|--------------------+-------+------------------------------------|
| Dropout            |   0.2 |                                    |
|--------------------+-------+------------------------------------|
| Dense              |   400 | relu                               |
|--------------------+-------+------------------------------------|
| Dropout            |   0.2 |                                    |
|--------------------+-------+------------------------------------|
| Dense              |   250 | relu                               |
|--------------------+-------+------------------------------------|
| Dropout            |   0.2 |                                    |
|--------------------+-------+------------------------------------|
| Dense              |    50 | relu                               |
|--------------------+-------+------------------------------------|
| Dense              |     1 | sigmoid                            |
|--------------------+-------+------------------------------------|

|----------+--------|
| accuracy |  score |
|----------+--------|
|   0.5425 | 0.7391 |
|----------+--------|
*** Spec 3
|--------------+--------+------------+---------------|
| max_features | maxlen | batch_size | learning_rate |
|--------------+--------+------------+---------------|
|        20000 |     80 |        164 |          0.01 |
|--------------+--------+------------+---------------|

|--------------------+-------+------------------------------------|
| Layer              | value | activation                         |
|--------------------+-------+------------------------------------|
| Embedding          |   128 |                                    |
|--------------------+-------+------------------------------------|
| Bidirectional LSTM |   128 | dropout 0.3, recurrent dropout 0.3 |
|--------------------+-------+------------------------------------|
| Dense              |   200 | relu                               |
|--------------------+-------+------------------------------------|
| Dense              |   400 | relu                               |
|--------------------+-------+------------------------------------|
| Dropout            |   0.4 |                                    |
|--------------------+-------+------------------------------------|
| Dense              |   300 | relu                               |
|--------------------+-------+------------------------------------|
| Dropout            |   0.4 |                                    |
|--------------------+-------+------------------------------------|
| Dense              |   200 | relu                               |
|--------------------+-------+------------------------------------|
| Dropout            |   0.4 |                                    |
|--------------------+-------+------------------------------------|
| Dense              |    50 | relu                               |
|--------------------+-------+------------------------------------|
| Dense              |     1 | sigmoid                            |
|--------------------+-------+------------------------------------|

|----------+--------|
| accuracy |  score |
|----------+--------|
|   0.5464 | 0.6963 |
|----------+--------|
** Convolutional model
*** Spec 1
|--------------+--------+------------+---------------|
| max_features | maxlen | batch_size | learning_rate |
|--------------+--------+------------+---------------|
|        20000 |    500 |        164 |          0.01 |
|--------------+--------+------------+---------------|

|-----------+-------+------------|
| Layer     | value | activation |
|-----------+-------+------------|
| Embedding |   128 |            |
|-----------+-------+------------|
| Conv1D    |    30 | relu       |
|-----------+-------+------------|
| MaxPool   |     2 |            |
|-----------+-------+------------|
| Conv1D    |    30 | relu       |
|-----------+-------+------------|
| MaxPool   |     2 |            |
|-----------+-------+------------|
| LSTM      |    30 |            |
|-----------+-------+------------|
| Dropout   |   0.5 |            |
|-----------+-------+------------|
| Dense     |    10 | tanh       |
|-----------+-------+------------|
| Dropout   |   0.5 |            |
|-----------+-------+------------|
| Dense     |     1 | sigmoid    |
|-----------+-------+------------|

|----------+--------|
| accuracy |  score |
|----------+--------|
|   0.5544 | 0.6975 |
|----------+--------|
*** Spec 2
|--------------+--------+------------+---------------|
| max_features | maxlen | batch_size | learning_rate |
|--------------+--------+------------+---------------|
|         5000 |    400 |         32 |          0.01 |
|--------------+--------+------------+---------------|

|---------------+-------+------------|
| Layer         | value | activation |
|---------------+-------+------------|
| Embedding     |    50 |            |
|---------------+-------+------------|
| Dropout       |   0.2 |            |
|---------------+-------+------------|
| Conv1D        |   250 | relu       |
|---------------+-------+------------|
| GlobalMaxPool |       |            |
|---------------+-------+------------|
| Dense         |   250 | relu       |
|---------------+-------+------------|
| Dropout       |   0.2 |            |
|---------------+-------+------------|
| Dense         |     1 | sigmoid    |
|---------------+-------+------------|

|----------+--------|
| accuracy |  score |
|----------+--------|
|   0.4937 | 8.1049 |
|----------+--------|
